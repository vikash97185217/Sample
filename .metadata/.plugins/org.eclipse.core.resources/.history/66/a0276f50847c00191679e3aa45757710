package com.demo;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;






import java.util.Arrays;
import java.util.List;

import com.demo.Country;
import com.demo.StaticRequest;
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;



public class InsertData {

	public static void main(String[] args) throws SQLException {
		Connection dbConnection = null;
		PreparedStatement preparedStatement = null;
		String insertTableSQL = "INSERT INTO innstanthotel_country_master"
				+ "(id, name, continent, region, regions__code, regions__name, countryCurrency) VALUES"
				+ "(?,?,?,?,?,?,?)";
		try{
		dbConnection = DbCOnnection.getDBConnection();
		preparedStatement = dbConnection.prepareStatement(insertTableSQL);
		InsertData obj=new InsertData();
		obj.insertData();
		dbConnection.setAutoCommit(false);

		preparedStatement.setString(1, "IN");
		preparedStatement.setString(2, "mkyong101");
		preparedStatement.setString(3, "system");
		preparedStatement.setString(4, "system");
		preparedStatement.setString(5, "system");
		preparedStatement.setString(6, "system");
		preparedStatement.setString(7, "system");
		preparedStatement.addBatch();

		preparedStatement.setString(1, "INI");
		preparedStatement.setString(2, "mkyong101");
		preparedStatement.setString(3, "system");
		preparedStatement.setString(4, "system");
		preparedStatement.setString(5, "system");
		preparedStatement.setString(6, "system");
		preparedStatement.setString(7, "system");
		preparedStatement.addBatch();


		int[] i=preparedStatement.executeBatch();
		System.out.println(i);
		dbConnection.commit();
		}catch (SQLException e) {

			System.out.println(e.getMessage());
			dbConnection.rollback();

		} finally {

			if (preparedStatement != null) {
				preparedStatement.close();
			}

			if (dbConnection != null) {
				dbConnection.close();
			}

		}
	}
public void insertData(){
	//String jsonData="[{\"id\":\"AD\",\"name\":\"Andorra\",\"continent\":\"Europe\",\"region\":\"Southern Europe\",\"regions\":[{\"code\":\"AN\",\"name\":\"Andorra la Vella\"},{\"code\":\"EE\",\"name\":\"Escaldes-Engordany\"}],\"countryCurrency\":\"EUR\"},{\"id\":\"AE\",\"name\":\"United Arab Emirates\",\"continent\":\"Asia\",\"region\":\"Middle East\",\"regions\":[{\"code\":\"DU\",\"name\":\"Dubayy\"},{\"code\":\"RK\",\"name\":\"Ra's al Khaymah\"},{\"code\":\"AZ\",\"name\":\"Abu Zaby\"},{\"code\":\"AJ\",\"name\":\"Ajman\"},{\"code\":\"FU\",\"name\":\"Al Fujayrah\"},{\"code\":\"SH\",\"name\":\"Ash Shariqah\"}],\"countryCurrency\":\"AED\"},{\"id\":\"AF\",\"name\":\"Afghanistan\",\"continent\":\"Asia\",\"region\":\"Southern and Central Asia\",\"regions\":[{\"code\":\"KB\",\"name\":\"Kabol\"}],\"countryCurrency\":\"AFA\"},{\"id\":\"AG\",\"name\":\"Antigua and Barbuda\",\"continent\":\"North America\",\"region\":\"Caribbean\",\"regions\":[{\"code\":\"PA\",\"name\":\"Saint Paul\"},{\"code\":\"MA\",\"name\":\"Saint Mary\"}],\"countryCurrency\":\"XCD\"},{\"id\":\"AI\",\"name\":\"Anguilla\",\"continent\":\"North America\",\"region\":\"Caribbean\",\"regions\":[{\"code\":\"AI\",\"name\":\"Anguilla\"}],\"countryCurrency\":\"XCD\"}]";
	String jsonData="[{\"id\":\"AD\",\"name\":\"Andorra\",\"continent\":\"Europe\",\"region\":\"Southern Europe\",\"regions\":[{\"code\":\"AN\",\"name\":\"Andorra la Vella\"},{\"code\":\"EE\",\"name\":\"Escaldes-Engordany\"}],\"countryCurrency\":\"EUR\"},{\"id\":\"AE\",\"name\":\"United Arab Emirates\",\"continent\":\"Asia\",\"region\":\"Middle East\",\"regions\":[{\"code\":\"DU\",\"name\":\"Dubayy\"},{\"code\":\"RK\",\"name\":\"Ra's al Khaymah\"},{\"code\":\"AZ\",\"name\":\"Abu Zaby\"},{\"code\":\"AJ\",\"name\":\"Ajman\"},{\"code\":\"FU\",\"name\":\"Al Fujayrah\"},{\"code\":\"SH\",\"name\":\"Ash Shariqah\"}],\"countryCurrency\":\"AED\"},{\"id\":\"AF\",\"name\":\"Afghanistan\",\"continent\":\"Asia\",\"region\":\"Southern and Central Asia\",\"regions\":[{\"code\":\"KB\",\"name\":\"Kabol\"}],\"countryCurrency\":\"AFA\"},{\"id\":\"AG\",\"name\":\"Antigua and Barbuda\",\"continent\":\"North America\",\"region\":\"Caribbean\",\"regions\":[{\"code\":\"PA\",\"name\":\"Saint Paul\"},{\"code\":\"MA\",\"name\":\"Saint Mary\"}],\"countryCurrency\":\"XCD\"},{\"id\":\"AI\",\"name\":\"Anguilla\",\"continent\":\"North America\",\"region\":\"Caribbean\",\"regions\":[{\"code\":\"AI\",\"name\":\"Anguilla\"}],\"countryCurrency\":\"XCD\"}]";
	String test = "[{\"id\":\"AD\"}]";
	StaticCountryResponse searchResult = null;
	try {
		 searchResult = (StaticCountryResponse) parseJsonObject(test, StaticCountryResponse.class);
	
	} catch (Exception e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}
	System.out.println(searchResult);
}



@SuppressWarnings("unchecked")
public Object parseJsonObject(String response,Class classtype)throws Exception{
	Object object=null;
	try{
		ObjectMapper mapper=new ObjectMapper();
		//5mapper.setSerializationInclusion(Include.NON_NULL);
		mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
		object=mapper.readValue(response, Arrays.class);
	}catch(Exception e){
		
	}
	return object;
}
}
